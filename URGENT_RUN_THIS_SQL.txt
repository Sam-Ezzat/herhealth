â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸš¨ URGENT: DATABASE MIGRATION NEEDED ğŸš¨                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Your backend is failing because the database migration hasn't been run yet.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ EASIEST METHOD - Use Neon Console (2 minutes):

1. Go to: https://console.neon.tech
2. Login and select your "herhealth" project
3. Click "SQL Editor" in the left sidebar
4. Copy the SQL below and paste it in the editor
5. Click "Run" button
6. Restart your backend server

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ SQL TO RUN (copy everything below):

-- Add color_code and notes to doctor_calendars table
ALTER TABLE doctor_calendars
ADD COLUMN IF NOT EXISTS color_code varchar(7) DEFAULT '#3B82F6',
ADD COLUMN IF NOT EXISTS color_name varchar(100),
ADD COLUMN IF NOT EXISTS notes text;

-- Add calendar_id to appointments table
ALTER TABLE appointments
ADD COLUMN IF NOT EXISTS calendar_id uuid REFERENCES doctor_calendars(id);

-- Create index for faster lookups
CREATE INDEX IF NOT EXISTS idx_appointments_calendar ON appointments(calendar_id);

-- Update existing appointments to link to their doctor's default calendar
UPDATE appointments a
SET calendar_id = (
  SELECT dc.id 
  FROM doctor_calendars dc 
  WHERE dc.doctor_id = a.doctor_id 
  AND dc.is_active = true 
  LIMIT 1
)
WHERE a.calendar_id IS NULL;

-- Verify success (should show 3 new columns)
SELECT column_name FROM information_schema.columns 
WHERE table_name = 'doctor_calendars' 
AND column_name IN ('color_code', 'color_name', 'notes');

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… AFTER MIGRATION:

1. You should see 3 rows returned from the verification query
2. Restart your backend: Stop the server (Ctrl+C) then run: npm run dev
3. The error "column color_code does not exist" will be gone
4. Test the feature:
   - Go to Settings â†’ Doctor Calendars
   - Create a calendar with a color
   - Book an appointment and select the calendar

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ ALTERNATIVE: Use pgAdmin or DBeaver

If you prefer a database client:
1. Open pgAdmin or DBeaver
2. Connect to: ep-lingering-water-a272rrqc.eu-central-1.aws.neon.tech
3. Open SQL query window
4. Paste the SQL above
5. Execute it

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
